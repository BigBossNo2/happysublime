<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">
    <title>权限</title>
    <link rel="stylesheet" href="../stylesheets/master.css" type="text/css" media="screen" charset="utf-8"/>
    <link rel="stylesheet" href="../stylesheets/pygments.css" type="text/css" media="screen" charset="utf-8"/>
    <link rel="icon" type="image/png" href="../images/lgcb.png" />
  </head>
  <body>
    <div id='wrapper'>
      <div class='header'>
        <h1>LGCB</h1>
        <h2>权限</h2>
      </div>
      <div id='menu'>
        <ul>
          <li><a href='../'>Home</a></li>
          <li><a href='../book'>Book</a></li>
        </ul>
      </div>
      <div class='content'>
        <p>sudo adduser deluser 这些是必须讲的，看看有没有必要单独开一节课</p>

<p><a href="http://v.youku.com/v_show/id_XMzYwNzc1MTY4.html">视频<img width="20" height="20" src="http://happypeter.github.com/LGCB-assets/misc/youku.png" /></a>
这一集我们集中火力，解决一个在 Linux 命令行实际操作中经常遇到的问题，”permission denied”。当我们想要创建或删除一个文件时，我们看到这个，当我们想要执行一个文件或者改动一个文件时也时不时的被这个报错信息虐待。好，我们受够了，这集视频之后，权限问题，我们将会驾轻就熟。</p>

<p>今天的视频我们分三部分：…</p>

<h3 id="section">什么是“权限”？</h3>
<div class="slide">
  <img src="/LGCB-assets/bash/perm_1.png" />
</div>
<p>用户对文件通常会涉及“读”，“写”，“执行”
三种权限，当然Linux系统还规定了其他一些权限，不常用。
&lt;div class="slide"&gt;
  <img src="/LGCB-assets/bash/perm_2.png" />
&lt;/div&gt;
Linux是一个多用户的操作系统，也就是很多用户可能同时使用一台计算机.
对于一个特定文件，系统会为他指定一个特定的用户(user)作为它的所有者(owner)。  同时也一定会指定一个由一个或多个人组成的group，作为这个文件的所有者组(owner group)， 严格的术语就叫组(group). 这两类之外的其他用户归为第三类人，叫world。这三类人各自的权限多少是可以任意指定的, 不一定谁多谁少，当然一般来讲owner的权限会多一些。
强调一下，就是在Linux系统中owner
是否属于这个group呢？可能属于，也可能不属于。
&lt;div class="slide"&gt;
  <img src="/LGCB-assets/bash/perm_3.png" />
&lt;/div&gt;
Linux对同一文件的权限控制，也是分了这三类人进行讨论的。权限问题基本上就是要讨论，所有者(owner) 对文件的是否具有“读”，“写”，“执行”的权限。同样，如果对组(group 或者叫owner group)，和其他人(world)的相应讨论也完成了，那权限就明晰了。</p>

<h3 id="file-mode">文件模式（file mode）</h3>
<div class="slide">
  <img src="/LGCB-assets/bash/perm_4.png" />
</div>
<p>那么我们回到实际情况。对于文件权限的规定是通过文件模式（file mode）来控制的。</p>

<p>如果我们执行<code>ls -l a.txt</code>,
得到的输出中，第一个<code>-</code>是关于“文件类型”的，这一位常见的情况有，<code>l</code> 表示符号链接，<code>d</code> 表示该文件是个目录，<code>-</code> 表示普通文件。</p>

<p>我们先跳过后面的9个字符，接下来的这个<code>1</code> 表示的是硬链接(hard link)的数目。前后两个<code>peter</code>分别代表拥有者(owner)名和组(group)名。<code>0</code>是文件大小，以字节为单位，这里明显是个空文件。接下来是“最后修改时间”。</p>

<p>那剩下的9位就是“文件模式”。可以分位三组。第一组（前3位）规定的是所有者（owner）对该文件的权限，第一位表示owner对该文件是否有读权限,<code>r</code>
表示有，<code>-</code>表示没有，第二位表示owner对该文件是否具有写权限，<code>w</code>代表有，<code>-</code>
代表没有，第三位表示owner对该文件是否具有执行的权限，<code>x</code>代表有，<code>-</code>
代表没有。中间三位代表组（group）的情况，最后三位是对其他人（world）。这里，所有者对该文件只有“读”和“写”的权限。那组和其他用户都只有读权限。</p>

<div class="slide">
  <img src="/LGCB-assets/bash/perm_5.png" />
</div>
<p>如果我们要对目录(directroy)查看权限的话，要用</p>

<pre><code>ls -ld mydir
</code></pre>

<p>同样是读写执行三种权限，对于普通文件和目录代表的意义是有差异的。
用户对文件有读权限，意味着用户可以查看文件的具体内容。
对目录来说，就是可以看目录中所包含的文件名（当然也可能包含子目录，不过目录也是一种特殊的文件）。
&lt;div class="slide"&gt;
  <img src="/LGCB-assets/bash/perm_6.png" />
&lt;/div&gt;
写权限对文件而言很好理解，就是我们可以修改里面的内容。那是不是也意味者我们可以对文件进行重命名或删除操作呢？
答案为否。这要看包含该文件的目录的权限。这就谈到了一个目录的写权限的意义，我们对于一个目录有写权限，意味着我们可以对其中包含的文件或子目录进行创建，重命名或删除（操作成功的前提是我们也同时拥有对该目录的执行权限）。
&lt;div class="slide"&gt;
  <img src="/LGCB-assets/bash/perm_7.png" />
&lt;/div&gt;
最后要谈的是执行权限(x),
我们对于一个二进制文件(例如程序的编译输出),或者是一些脚本文件，例如shell脚本，python脚本执行权限才有意义。
但是如果我们文件里存的是笔记或者是C程序的源代码，那执行权限是没有什么意义的。这就是为什么系统上的大部分普通文件，如果我们用<code>ls
-l</code>查看一下的话，都是没有执行权限的。但是正好相对的，我们用<code>ls
-ld</code>查看一下系统上的目录，发现基本上都是有执行权限的。
对于没有执行权限的目录，我们是不能跳转进去的，所以有没有执行权限，意味者我们能不能成功的<code>cd</code>到该目录里。</p>

<h3 id="chmod">修改文件模式(chmod)</h3>
<div class="slide">
  <img src="/LGCB-assets/bash/perm_8.png" />
</div>
<p>我们可以通过chmod这个命令来更改文件模式，也就是更改各类用户的具体权限。如果我们想对“组”用户和“其他”用户，在<code>a.txt</code>都加上写的权限，那么可以凭空想象出这样一个命令</p>

<pre><code>chmod rw-rw-rw- a.txt
</code></pre>

<p>但是实际这个命令系统是不认的。然后，我们用1代表“使能”，0代表“禁止”，可以得到</p>

<pre><code>chmod 110110110 a.txt
</code></pre>

<p>那这个逻辑也是清晰的，但是很不幸<code>110110110</code>也不是chmod的合法参数。
我们再把这个参数写的短一点，也就是把它们分三组分别八进制表示。最后得到的</p>

<pre><code>chmod 666 a.txt
</code></pre>

<p>是一个正确的系统命令，最后实现了我们的目的。
&lt;div class="slide"&gt;
  <img src="/LGCB-assets/bash/perm_9.png" />
&lt;/div&gt;
除了用三个8进制数来做chmod的参数之外，chmod也支持符号参数。不过我们首先要对三类人起一个简短的别名，那就是用<code>u</code>（User）来代表owner，<code>g</code>代表group，<code>o</code>（others）代表world。那么如果最初a.txt的权限情况是</p>

<pre><code>$ ls -l a.txt
  -rw-r--r--
</code></pre>

<p>那么我么执行</p>

<pre><code>$ chmod a+x a.txt
</code></pre>

<p>就会得到</p>

<pre><code>$ ls -l a.txt
  -rwxr-xr-x
</code></pre>

<p>再执行：</p>

<pre><code>$ chmod g+w a.txt
</code></pre>

<p>就变成</p>

<pre><code>$ ls -l a.txt
  -rwxrwxr-x
</code></pre>

<p>再把World中的人的读和执行权限一步都剥夺</p>

<pre><code>$ chmod o-rx a.txt
</code></pre>

<p>就是</p>

<pre><code>$ ls -l a.txt
  -rwxrwx---
</code></pre>

<p>最后如果想回<code>-rw-r--r--</code>的状态呢，可能用这种符号表示法，就不如数字表示方便了，所以我们用</p>

<pre><code>$ chmod 644 a.txt
</code></pre>

        <div class='clearfix'></div>
      </div>
    </div>
    <div id='footer'>
      Hosted by <a href='http://github.com' target='_blank'>GitHub</a> and powered by <a href='http://github.com/mojombo/jekyll'>Jekyll</a>.
    </div>
  </body>
</html>

